<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="/static/styles/custom.css" />
    <script
      src="https://res.cdn.office.net/teams-js/2.9.1/js/MicrosoftTeams.min.js"
      integrity="sha384-xnsUQ1tUqsrutBJl0vuf4/hufzLFWW8ZhGnhItfpQ0/BtWgM2uw6YT6BQ5YaKBSM"
      crossorigin="anonymous"
    ></script>
    <script src="/static/scripts/teamsapp.js"></script>
    <title>Microsoft Teams Tab</title>
  </head>

  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <script
    type="text/javascript"
    src="https://alcdn.msauth.net/browser/2.3.0/js/msal-browser.min.js"
    integrity="sha384-o+Sncs5XJ3NEAeriM/FV8YGZrh7mZk4GfNutRTbYjsDNJxb7caCLeqiDabistgwW"
    crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>



    <div>
      <h1>Hello, World</h1>
      <span>
        <p>Your app is running</p>
        <p id="hubState"></p>
        <div class="card body">
          <button type="button" class="btn btn-primary" onclick="Signin()">Sign In</button>
          <button type="button" style="display: none;" class="btn btn-success">Sign Out</button>                    
      </div> 
      </span>
    </div>
    <script type="text/javascript">
        const msalconfig = {
            auth: {
                clientId:"3b83070f-1545-4ac8-bdf3-720661f41a50",
                authority:"https://login.microsoftonline.com/29053aa4-6a7e-4769-a948-245a377b85c9",
                redirectUI:"http:/localhost:3000"
            },
            cache: {
                cacheLocation: "sessionStorage",
                storeAuthStateInCookie:false
            }
        }

        const MSALobj = new msal.PublicClientApplication(msalconfig);

        function Signin() {
            console.log('Enter signin function');
            const loginscope = {
                scope:["User.Read"],
            }
            MSALobj.loginRedirect(loginscope);
        }

        MSALobj.handleRedirectPromise().then((response)=> {
            console.log(response);
        }).catch((error) => {console.error(error)});
      microsoftTeams.appInitialization.notifySuccess();
    </script>
  </body>
</html>
